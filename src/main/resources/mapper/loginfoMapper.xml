<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.springboot.dao.LoginfoDao">

	<insert id="insertLoginfo" parameterType="Loginfo">
		insert into loginfo values(null, #{context}, #{date}, #{user.id}, #{pipe.id})
	</insert>

	
	<select id="findListLoginfo" parameterType="Map" resultMap="loginfoMap">
		select l.*, u.name u_name from loginfo l left join users u on u.id = l.userid
		<where>
			<if test="pipe != null">
				and l.pipeid = #{pipe.id}
			</if>
		</where>
		order by l.id
	</select>
	
	<resultMap id="loginfoMap" type="loginfo">
		<id property="id" column="id"/>
		<result property="context" column="context"/>
		<result property="date" column="date"/>
		<result property="user.name" column="u_name"/>
	</resultMap>
	
</mapper>
 